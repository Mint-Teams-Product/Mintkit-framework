<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MintAssembly Demo</title>
</head>

<body>
  <div id="app"></div>

  <script type="module">
    import { Mint } from "https://cdn.jsdelivr.net/gh/Peakk2011/Mintkit@main/mintkit/mint.js";
    import { MintAssembly } from "./MintASM.js";

    const root = '#app';

    const appTemplate = `
      <h1>\${title}</h1>
      <p>Counter: \${count}</p>
      <button @click="increment()">Increment</button>
      <button @click="decrement()" :disabled="count <= 0">Decrement</button>

      <hr>

      <h2>Product Details</h2>
      <h3>\${product.name}</h3>
      <p>Price: \${product.price | currency}</p>
      <p>Description: \${product.description | truncate(30)}</p>

      <if condition="product.stock > 0">
          <p style="color: green;">In Stock (\${product.stock} left)</p>
      </if>
      <else>
          <p style="color: red;">Out of Stock</p>
      </else>

      <ul>
        <for item="tag" in="product.tags">
          <li>\${tag}</li>
        </for>
      </ul>
    `;

    const appCSS = `
      * { margin: 0; padding: 0; box-sizing: border-box; }
      html, body {
        background: #121212;
        color: #f5f5f5;
        font-family: sans-serif;
        padding: 1rem;
      }
      button {
        margin: 0.25rem 0.5rem 0.25rem 0;
        padding: 0.5rem 1rem;
        border: none;
        background: #3498db;
        color: white;
        cursor: pointer;
        border-radius: 6px;
      }
      button:disabled {
        background: #555;
        cursor: not-allowed;
      }
      hr {
        margin: 1rem 0;
        border: 1px solid #333;
      }
    `;

    const context = {
      title: 'MintAssembly Demo',
      count: 0,
      product: {
        name: 'MintKit Pro',
        price: 199.99,
        stock: 100,
        tags: ['js', 'framework', 'ui'],
        description: 'A powerful kit for building modern web applications.'
      },
      increment: () => {
        context.count++;
        render();
      },
      decrement: () => {
        if (context.count > 0) {
          context.count--;
          render();
        }
      }
    };

    const mint = MintAssembly({
      template: appTemplate,
      context,
      debug: true
    });

    function render() {
      mint.mount(root);
    }

    document.addEventListener('DOMContentLoaded', () => {
      Mint.injectTitle(`<title>${context.title}</title>`);
      Mint.injectCSS(appCSS);
      render();
    });
  </script>
</body>

</html>